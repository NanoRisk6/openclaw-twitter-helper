#!/bin/zsh
set -euo pipefail
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
PY_BIN="python3"
if [[ -x "$SCRIPT_DIR/.venv/bin/python" ]]; then
  PY_BIN="$SCRIPT_DIR/.venv/bin/python"
fi
export PYTHONPATH="$SCRIPT_DIR${PYTHONPATH:+:$PYTHONPATH}"
FIRST_ARG="${1:-}"
case "$FIRST_ARG" in
  start|memory)
    exec "$PY_BIN" "$SCRIPT_DIR/src/reply_engine_loop.py" "$@"
    ;;
esac
exec "$PY_BIN" -m src.reply_engine.cli "$@"
